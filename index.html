<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Construction Dashboard AI - Pertamina</title>

  <!-- CSS -->
  <link rel="stylesheet" href="style.css" />

  <!-- Libs -->
  <script src="chart.js"></script>
  <script src="xlsx.full.min.js"></script>
  <script src="pptxgen.bundle.js"></script>
</head>
<body>

  <!-- Sidebar -->
  <aside class="sidebar" id="sidebar">
    <div class="sidebar-header">
      <h2>Construction AI</h2>
      <div style="color:var(--color-text-secondary);font-size:12px;">Pertamina Dashboard</div>
    </div>

    <nav class="sidebar-nav">
      <a href="#" class="nav-link active" data-section="overview">
        <span class="nav-icon">üè†</span> <span>Overview</span>
      </a>
      <a href="#" class="nav-link" data-section="excel-management">
        <span class="nav-icon">üì•</span> <span>Upload Data Excel</span>
      </a>
      <a href="#" class="nav-link" data-section="scheduler">
        <span class="nav-icon">üóìÔ∏è</span> <span>AI Scheduler</span>
      </a>
      <a href="#" class="nav-link" data-section="permits">
        <span class="nav-icon">üõ°Ô∏è</span> <span>Monitoring Safety</span>
      </a>
      <a href="#" class="nav-link" data-section="documents">
        <span class="nav-icon">üîé</span> <span>Smart Document</span>
      </a>
      <a href="#" class="nav-link" data-section="reports">
        <span class="nav-icon">üìä</span> <span>Generator Laporan</span>
      </a>
    </nav>
  </aside>

  <button class="sidebar-toggle" type="button" aria-controls="sidebar" aria-expanded="false">
    <span class="sr-only">Toggle navigasi</span>
    <span class="sidebar-toggle__bar" aria-hidden="true"></span>
    <span class="sidebar-toggle__bar" aria-hidden="true"></span>
    <span class="sidebar-toggle__bar" aria-hidden="true"></span>
  </button>

  <div class="sidebar-overlay" aria-hidden="true"></div>

  <!-- Main -->
  <main class="main-content">

    <!-- OVERVIEW -->
    <section id="overview" class="content-section active">
      <div class="page-header">
        <h1>Dashboard Overview</h1>
        <div class="filter-container">
          <select id="projectFilter" class="form-control project-filter">
            <option value="all">Semua Proyek</option>
            <option>Petani Substation</option>
            <option>Menggala Substation</option>
            <option>Nella Substation</option>
            <option>Bangko Substation</option>
            <option>Balam SS</option>
            <option>Sintong SS</option>
            <option>OKB Substation</option>
          </select>
        </div>
      </div>

      <div class="kpi-grid">
        <div class="kpi-card">
          <div class="kpi-icon">üèóÔ∏è</div>
          <div class="kpi-content">
            <h3 id="totalProjects">0</h3>
            <p>Total Proyek</p>
          </div>
        </div>
        <div class="kpi-card">
          <div class="kpi-icon">üìã</div>
          <div class="kpi-content">
            <h3 id="activePermits">0</h3>
            <p>Permit Aktif</p>
          </div>
        </div>
        <div class="kpi-card">
          <div class="kpi-icon">üõ°Ô∏è</div>
          <div class="kpi-content">
            <h3 id="safetyScore">0%</h3>
            <p>Skor Safety</p>
          </div>
        </div>
        <div class="kpi-card">
          <div class="kpi-icon">üí∞</div>
          <div class="kpi-content">
            <h3 id="budgetPerformance">0%</h3>
            <p>Performa Budget</p>
          </div>
        </div>
      </div>

      <div class="charts-grid">
        <div class="chart-container">
          <h3>Progress Proyek</h3>
          <canvas id="progressChart"></canvas>
        </div>
        <div class="chart-container">
          <h3>Safety Trend - Keseluruhan Proyek</h3>
          <canvas id="safetyChart"></canvas>
        </div>
      </div>

      <div id="emptyState" class="empty-state" style="display:none;">
        Tidak ada data untuk proyek yang dipilih.
      </div>
    </section>

    <!-- EXCEL MANAGEMENT -->
    <section id="excel-management" class="content-section">
      <div class="page-header">
        <h1>Upload Data Excel</h1>
        <p style="color:var(--color-text-secondary);margin:0;">
          Upload satu file Excel berisi sheet: <b>Projects, S_Curve, Safety, Issues, Plans, Documents, Permits</b>
        </p>
      </div>

      <div class="excel-grid">
        <div class="card upload-area">
          <div class="card__body">
            <div id="dropZone" class="drop-zone">
              <div class="drop-zone-content">
                <div class="drop-zone-icon">üìÅ</div>
                <p>Drag & drop file Excel di sini atau klik untuk browse</p>
                <input type="file" id="fileInput" accept=".xlsx,.xls" style="display:none" />
                <button class="btn btn--secondary" onclick="document.getElementById('fileInput').click()">Pilih File Excel</button>
              </div>
            </div>

            <div id="uploadProgress" class="upload-progress" style="display:none;">
              <div class="progress-bar"><div id="progressBar" class="progress-fill"></div></div>
              <p id="progressText">Uploading... 0%</p>
            </div>

            <div id="validationResults" class="validation-results"></div>
          </div>
        </div>

        <div class="card actions-card">
          <div class="card__body">
            <h3>Actions</h3>
            <div class="action-buttons">
              <a class="btn btn--primary btn--full-width" href="#" download="Dashboard_Complete_Final.xlsx">üì• Download Template Lengkap</a>
              <button class="btn btn--outline btn--full-width" onclick="downloadCurrentData()">üìä Download Data Saat Ini</button>
            </div>
            <div class="template-info">
              <strong>Template berisi:</strong>
              <ul>
                <li>Projects, S_Curve, Safety</li>
                <li>Issues, Plans, Documents, Permits</li>
              </ul>
            </div>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card__header"><h3>Upload History</h3></div>
        <div class="card__body">
          <div class="table-container">
            <table id="uploadHistoryTable">
              <thead>
                <tr>
                  <th>File Name</th><th>Upload Date</th><th>Size</th><th>Records</th><th>Sheets</th><th>Status</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
      </div>
    </section>

    <!-- SCHEDULER -->
    <section id="scheduler" class="content-section">
      <div class="page-header">
        <h1>AI Scheduler</h1>
        <div class="filter-container">
          <select id="schedulerProjectFilter" class="form-control project-filter">
            <option value="all">Semua Proyek</option>
            <option>Petani Substation</option>
            <option>Menggala Substation</option>
            <option>Nella Substation</option>
            <option>Bangko Substation</option>
            <option>Balam SS</option>
            <option>Sintong SS</option>
            <option>OKB Substation</option>
          </select>
        </div>
      </div>

      <div class="scheduler-info-box">
        <p><strong>Info:</strong> Upload sheet <strong>S_Curve</strong> dan <strong>Issues/Plans</strong>. Grafik S-Curve mendukung label minggu/bulan.</p>
      </div>

      <div class="scheduler-grid">
        <div class="chart-container">
          <h3>S-Curve Analysis</h3>
          <canvas id="sCurveChart"></canvas>
        </div>

        <div class="scheduler-tables-grid">
          <div class="card">
            <div class="card__header"><h3>Issues Status</h3></div>
            <div class="card__body">
              <div class="table-container">
                <table id="issuesTable">
                  <thead>
                    <tr>
                      <th>Issue ID</th><th>Project</th><th>Title</th><th>Priority</th>
                      <th>Status</th><th>Assigned To</th><th>Due Date</th>
                    </tr>
                  </thead>
                  <tbody></tbody>
                </table>
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card__header"><h3>Next Plans</h3></div>
            <div class="card__body">
              <div class="table-container">
                <table id="plansTable">
                  <thead>
                    <tr>
                      <th>Plan ID</th><th>Project</th><th>Title</th><th>Priority</th>
                      <th>Status</th><th>Assigned To</th><th>Start Date</th><th>End Date</th>
                    </tr>
                  </thead>
                  <tbody></tbody>
                </table>
              </div>
            </div>
          </div>

        </div>
      </div>
    </section>

    <!-- PERMITS / SAFETY -->
    <section id="permits" class="content-section">
      <div class="page-header">
        <h1>Monitoring Safety</h1>
        <div class="filter-container">
          <select id="safetyProjectFilter" class="form-control project-filter">
            <option value="all">Semua Proyek</option>
            <option>Petani Substation</option>
            <option>Menggala Substation</option>
            <option>Nella Substation</option>
            <option>Bangko Substation</option>
            <option>Balam SS</option>
            <option>Sintong SS</option>
            <option>OKB Substation</option>
          </select>
        </div>
      </div>

      <div class="permits-grid">
        <div class="chart-container">
          <h3>Safety Pyramid</h3>
          <canvas id="safetyPyramidChart"></canvas>
        </div>

        <div class="card">
          <div class="card__header"><h3>Active Permits</h3></div>
          <div class="card__body"><div id="activePermitsList" class="permits-list"></div></div>
        </div>

        <div class="card safety-kpis">
          <div class="card__header"><h3>Safety KPIs</h3></div>
          <div class="card__body">
            <div class="safety-metrics">
              <div class="metric-item"><div id="totalManpower" class="metric-value">0</div><div class="metric-label">Total Manpower</div></div>
              <div class="metric-item"><div id="safeManHours" class="metric-value">0</div><div class="metric-label">Safe Man Hours</div></div>
              <div class="metric-item"><div id="incidentRate" class="metric-value">0%</div><div class="metric-label">Incident Rate</div></div>
            </div>
          </div>
        </div>
      </div>

      <div class="card" style="margin-top:24px">
        <div class="card__header"><h3>Data Safety Details</h3></div>
        <div class="card__body">
          <div class="table-container">
            <table id="safetyTable">
              <thead>
                <tr>
                  <th>Date</th><th>Project</th><th>Safety Score</th><th>Total Manpower</th>
                  <th>Safe Man Hours</th><th>Incidents</th><th>Status</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
      </div>
    </section>

    <!-- DOCUMENTS -->
    <section id="documents" class="content-section">
      <div class="page-header">
        <h1>Smart Document Search</h1>
        <p style="color:var(--color-text-secondary);margin:0;">Cari dokumen dari sheet <b>Documents</b>.</p>
      </div>

      <div class="search-controls">
        <div class="search-bar">
          <input id="documentSearch" class="form-control" placeholder="Cari nama, tipe, project, atau keywords‚Ä¶" />
          <button class="btn btn--primary" onclick="performDocumentSearch()">üîç</button>
        </div>
        <div class="search-filters">
          <select id="documentTypeFilter" class="form-control">
            <option value="all">Semua Tipe</option>
            <option>Contract</option><option>Report</option><option>Drawing</option>
            <option>Specification</option><option>Manual</option>
          </select>
          <select id="documentProjectFilter" class="form-control">
            <option value="all">Semua Project</option>
            <option>Petani Substation</option>
            <option>Menggala Substation</option>
            <option>Nella Substation</option>
            <option>Bangko Substation</option>
            <option>Balam SS</option>
            <option>Sintong SS</option>
            <option>OKB Substation</option>
          </select>
        </div>
      </div>

      <div id="searchResults" class="search-results-info">Menampilkan 0 dokumen</div>
      <div id="documentsGrid" class="documents-grid"></div>
    </section>

    <!-- REPORTS -->
    <section id="reports" class="content-section">
      <div class="page-header"><h1>Generator Laporan PowerPoint</h1></div>
      <div class="reports-grid">
        <div class="card">
          <div class="card__header"><h3>Konfigurasi Laporan</h3></div>
          <div class="card__body">
            <div class="form-group">
              <label class="form-label">Tipe Laporan</label>
              <select id="reportType" class="form-control">
                <option value="daily">Daily Report</option>
                <option value="weekly">Weekly Report</option>
                <option value="monthly">Monthly Report</option>
                <option value="project">Project Report</option>
              </select>
            </div>
            <div class="form-group">
              <label class="form-label">Periode Dari</label>
              <input type="date" id="startDate" class="form-control" />
            </div>
            <div class="form-group">
              <label class="form-label">Periode Sampai</label>
              <input type="date" id="endDate" class="form-control" />
            </div>
            <div class="form-group">
              <label class="form-label">Proyek</label>
              <select id="reportProject" class="form-control">
                <option value="all">Semua Proyek</option>
                <option>Petani Substation</option>
                <option>Menggala Substation</option>
                <option>Nella Substation</option>
                <option>Bangko Substation</option>
                <option>Balam SS</option>
                <option>Sintong SS</option>
                <option>OKB Substation</option>
              </select>
            </div>
            <button id="generateReport" class="btn btn--primary btn--full-width">üìä Generate PowerPoint Report</button>
          </div>
        </div>

        <div class="card">
          <div class="card__header"><h3>Preview Data</h3></div>
          <div class="card__body">
            <div id="reportPreview" class="report-preview">
              <div class="preview-item"><strong>Total Proyek:</strong> <span id="previewProjects">0</span></div>
              <div class="preview-item"><strong>Active Permits:</strong> <span id="previewPermits">0</span></div>
              <div class="preview-item"><strong>Total Issues:</strong> <span id="previewIssues">0</span></div>
              <div class="preview-item"><strong>Total Plans:</strong> <span id="previewPlans">0</span></div>
              <div class="preview-item"><strong>Safety Score Rata-rata:</strong> <span id="previewSafety">0%</span></div>
            </div>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card__header"><h3>Generated Reports</h3></div>
        <div class="card__body">
          <div class="table-container">
            <table id="reportsTable">
              <thead>
                <tr>
                  <th>File Name</th><th>Type</th><th>Project</th><th>Period</th><th>Created Date</th><th>Status</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
      </div>
    </section>

  </main>

  <!-- Document Modal -->
  <div id="documentModal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-header">
        <h3 id="modalTitle">Document Preview</h3>
        <button class="modal-close" onclick="closeDocumentModal()">√ó</button>
      </div>
      <div id="documentPreview" class="modal-body"></div>
    </div>
  </div>

  <!-- Notifications -->
  <div id="notifications" class="notifications-container"></div>

  <!-- Chatbot -->
  <div id="chatbot" class="chatbot collapsed">
    <div class="chatbot-header" onclick="toggleChatbot()">
      <span>ü§ñ AI Assistant</span><span class="chatbot-toggle">‚ñº</span>
    </div>
    <div class="chatbot-content">
      <div id="chatMessages" class="chat-messages">
        <div class="message bot-message">Halo! Upload Excel 7 sheet untuk update semua data.</div>
      </div>
      <div class="quick-questions">
        <button class="quick-question" onclick="askQuestion('Cara upload Excel?')">Cara upload Excel?</button>
        <button class="quick-question" onclick="askQuestion('Status safety terbaru?')">Status safety terbaru?</button>
        <button class="quick-question" onclick="askQuestion('Generate report PowerPoint?')">Generate report PowerPoint?</button>
      </div>
      <div class="chat-input">
        <input id="chatInput" type="text" placeholder="Ketik pesan Anda..." onkeypress="handleChatInput(event)" />
        <button onclick="sendChatMessage()">üì§</button>
      </div>
    </div>
  </div>

  <!-- App JS -->
  <script src="app.js"></script>
</body>
</html>

